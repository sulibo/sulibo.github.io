<!DOCTYPE html>
<html lang="en">





<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="This post is a tutorial on solving the Kaggle Titanic Competition using Deep Neural Network with the TensorFlow API Keras. Kaggle is a competition site which...">
  <meta name="keywords" content="Time Delay System and Control Theory">
  <meta name="author" content="Yet Another Kaggle Titanic Competition Tutorial | Libo Su&#39;s Blog">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#f5f5f5">

  <!-- Twitter Tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Yet Another Kaggle Titanic Competition Tutorial | Libo Su&#39;s Blog">
  <meta name="twitter:description" content="This post is a tutorial on solving the Kaggle Titanic Competition using Deep Neural Network with the TensorFlow API Keras. Kaggle is a competition site which...">
  
    <meta property="twitter:image" content="https://sulibo.github.io/assets/img/leonids-logo.png">
  

  <!-- Open Graph Tags -->
  <meta property="og:type" content="blog">
  <meta property="og:url" content="https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras">
  <meta property="og:title" content="Yet Another Kaggle Titanic Competition Tutorial | Libo Su&#39;s Blog">
  <meta property="og:description" content="This post is a tutorial on solving the Kaggle Titanic Competition using Deep Neural Network with the TensorFlow API Keras. Kaggle is a competition site which...">
  
    <meta property="og:image" content="https://sulibo.github.io/assets/img/leonids-logo.png">
  
  <title>Yet Another Kaggle Titanic Competition Tutorial | Libo Su's Blog</title>

  <!-- CSS files -->
  <link rel="stylesheet" href="https://sulibo.github.io/assets/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://sulibo.github.io/assets/css/main.css">

  <link rel="canonical" href="https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras">
  <link rel="alternate" type="application/rss+xml" title="Libo Su&#39;s Blog" href="https://sulibo.github.io/feed.xml" />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="https://sulibo.github.io/favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="https://sulibo.github.io/favicon.png">
</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
        

<div class="cover-card table-cell table-middle">
  
  <a href="https://sulibo.github.io/">
    <img src="https://sulibo.github.io/assets/img/avatar.jpg" alt="" class="avatar">
  </a>
  
  <a href="https://sulibo.github.io/" class="author_name">Libo Su</a>
  <span class="author_job">PhD Candidate</span>
  <span class="author_bio mbm">A PhD Candidate at KU Leuven, Belgium and Eindhoven University of Technology, the Netherlands</span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="https://sulibo.github.io/">home</a>
      </li>
       
      <li class="nav-item">
         <span>/</span>
         <a href="https://sulibo.github.io/about/">About</a>
      </li>
        
      <li class="nav-item">
         <span>/</span>
         <a href="https://sulibo.github.io/archive/">Archive</a>
      </li>
        
      <li class="nav-item">
         <span>/</span>
         <a href="https://sulibo.github.io/categories/">Categories</a>
      </li>
              
      <li class="nav-item">
         <span>/</span>
         <a href="https://sulibo.github.io/tags/">Tags</a>
      </li>
           
    </ul>
  </nav>
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
      <li>
      <script>gen_mail_to_link('sulibozju@gmail.com', 'Hello from website');</script>
      </li>
    
    <li><a href="http://twitter.com/sulibozju" class="social-link-item" target="_blank"><i class="fa fa-fw fa-twitter"></i></a></li>
    
    
    <li><a href="http://linkedin.com/in/sulibo" class="social-link-item" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a></li>
    
    
    
    <li><a href="http://github.com/sulibo" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    <li><a href="http://www.weibo.com/1923994851" class="social-link-item" target="_blank"><i class="fa fa-fw fa-weibo"></i></a></li>
    
    
    
  </ul>
</div>


  <!--table of content
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
      <li>
      <script>gen_mail_to_link('sulibozju@gmail.com', 'Hello from website');</script>
      </li>
    
    <li><a href="http://twitter.com/sulibozju" class="social-link-item" target="_blank"><i class="fa fa-fw fa-twitter"></i></a></li>
    
    
    <li><a href="http://linkedin.com/in/sulibo" class="social-link-item" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a></li>
    
    
    
    <li><a href="http://github.com/sulibo" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    <li><a href="http://www.weibo.com/1923994851" class="social-link-item" target="_blank"><i class="fa fa-fw fa-weibo"></i></a></li>
    
    
    
  </ul>
</div>

  
    
    
      <div style="background-color:	#F6F6F6F6;text-align: left; display: table; padding: 0em -10em 0em 0.5em;">
        <h4>Table of Contents</h4>
        
      <ol>
  <li><a href="#define-the-problem">Define the problem</a></li>
  <li><a href="#acquire-the-data">Acquire the data</a></li>
  <li><a href="#prepare-the-data">Prepare the data</a>
    <ol>
      <li><a href="#data-overview">Data Overview</a></li>
      <li><a href="#primary-data-analysis-and-visualization">Primary data analysis and visualization</a>
        <ol>
          <li><a href="#sex">Sex</a></li>
          <li><a href="#class">Class</a></li>
          <li><a href="#family-size">Family size</a></li>
          <li><a href="#age">Age</a></li>
          <li><a href="#fare">Fare</a></li>
          <li><a href="#embarked-port">Embarked port</a></li>
          <li><a href="#name-title">Name (Title)</a></li>
          <li><a href="#cabin">Cabin</a></li>
        </ol>
      </li>
      <li><a href="#data-pre-processing">Data pre-processing</a>
        <ol>
          <li><a href="#combine-all-data">Combine all data</a></li>
          <li><a href="#fill-the-missing-values">Fill the missing values</a>
            <ol>
              <li><a href="#embarked">Embarked</a></li>
              <li><a href="#fare-1">Fare</a></li>
              <li><a href="#age-1">Age</a></li>
            </ol>
          </li>
          <li><a href="#select-the-features">Select the features</a></li>
          <li><a href="#one-hot-encoding">One-hot encoding</a></li>
          <li><a href="#normalization">Normalization</a></li>
        </ol>
      </li>
      <li><a href="#split-the-dataset">Split the dataset</a></li>
    </ol>
  </li>
  <li><a href="#define-the-model">Define the model</a></li>
  <li><a href="#train-and-fine-tune-model">Train and fine-tune model</a></li>
  <li><a href="#test-and-deploy-model">Test and deploy model</a></li>
  <li><a href="#references">References</a></li>
</ol>

    
      </div>
    
  
  -->
</div>


      </div>
    </div>
    <div class="col s12 m6">
      <div class="post-listing">
        <a class="btn" href= "https://sulibo.github.io/" >
  Home
</a>



<div id="post">
  <header class="post-header">
    <h1 title="Yet Another Kaggle Titanic Competition Tutorial">Yet Another Kaggle Titanic Competition Tutorial</h1>
    <span class="post-meta">
      <span class="post-date">
        23 NOV 2020
      </span>
      •
      <span class="read-time" title="Estimated read time">
  
  
    27 mins read
  
</span>

    </span>

  </header>


  <article class="post-content">
    <p>This post is a tutorial on solving the <a href="https://www.kaggle.com/c/titanic">Kaggle Titanic Competition</a> using Deep Neural Network with the <a href="https://www.tensorflow.org">TensorFlow</a> API <a href="https://keras.io">Keras</a>. <a href="https://www.kaggle.com">Kaggle</a> is a competition site which provides problems to solve or questions to ask while providing the datasets for training your data science model and testing the model results against a test dataset. 
<!--more-->
The Titanic competition is probably the first competition you will come across on Kaggle. The goal of the competition is to predict the possibility of survival of the passengers onboard, a typical classification problem.</p>

<p>This tutorial follows a typical workflow of machine learning project.</p>
<ol>
  <li>Define the problem</li>
  <li>Acquire the data</li>
  <li>Prepare the data</li>
  <li>Define the model</li>
  <li>Train and fine-tune the model</li>
  <li>Test and deploy the model</li>
</ol>

<p>The accompanying notebook of this tutorial is available <a href="https://github.com/sulibo/code_snipets/tree/main/Machine_Learning/Kaggle/Titanic">here</a>.</p>

<h2 id="define-the-problem">Define the problem</h2>
<p>The question or problem definition for Titanic Survival competition is <a href="https://www.kaggle.com/c/titanic">described here at Kaggle</a>.</p>

<blockquote>
  <p>Knowing from a training set of samples listing passengers who survived or did not survive the Titanic disaster, can our model determine based on a given test dataset not containing the survival information, if these passengers in the test dataset survived or not.</p>
</blockquote>

<p>Kaggle already provides some early understanding about the domain of this problem, see the <a href="https://www.kaggle.com/c/titanic">Kaggle competition description page here</a>. Here are the highlights to note.</p>

<ul>
  <li>On April 15, 1912, during her maiden voyage, the Titanic sank after colliding with an iceberg, killing 1502 out of 2224 passengers and crew. Translated 32% survival rate.</li>
  <li>One of the reasons that the shipwreck led to such loss of life was that there were not enough lifeboats for the passengers and crew.</li>
  <li>Although there was some element of luck involved in surviving the sinking, some groups of people were more likely to survive than others, such as women, children, and the upper-class.</li>
</ul>

<p>Before going forward, we need to import some necessary modules.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># data analysis
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> 

<span class="c1"># visualization 
</span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span> 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="n">sns</span> 

<span class="c1"># machine learning 
</span><span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="n">tf</span>
<span class="kn">from</span> <span class="nn">tensorflow.python.framework</span> <span class="kn">import</span> <span class="n">ops</span>

<span class="c1"># utils
</span><span class="kn">import</span> <span class="nn">warnings</span> 
<span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s">'ignore'</span><span class="p">)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre></div></div>

<h2 id="acquire-the-data">Acquire the data</h2>

<p>The Python Pandas packages are used to acquire the data. The data consists of two groups: a training set (train.csv)
and test set (test.csv).</p>

<p>The training set should be used to build the machine learning models. For the training set, the outcome (also known as the “ground truth”) for each passenger is provided.</p>

<p>The test set should be used to see how well your model performs on unseen data. For the test set, the ground truth for each passenger is not provided. The machine learning models will be used to predict the surival of each passenger.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Dataset/train.csv'</span><span class="p">)</span>
<span class="n">test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Dataset/test.csv'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>892</td>
      <td>3</td>
      <td>Kelly, Mr. James</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>1</th>
      <td>893</td>
      <td>3</td>
      <td>Wilkes, Mrs. James (Ellen Needs)</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>2</th>
      <td>894</td>
      <td>2</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>3</th>
      <td>895</td>
      <td>3</td>
      <td>Wirz, Mr. Albert</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>4</th>
      <td>896</td>
      <td>3</td>
      <td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="prepare-the-data">Prepare the data</h2>
<p>This step aims to prepare the data for use in machine learning training. It involves cleaning up the data, understanding its structure and attributes, studying possible correlations between attributes, and visualizing the data to extract human-level insight on its properties, distribution, range, and overall usefulness <a href="#ref3">[3]</a>.</p>

<h3 id="data-overview">Data Overview</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"-"</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 891 entries, 0 to 890
Data columns (total 12 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  891 non-null    int64  
 1   Survived     891 non-null    int64  
 2   Pclass       891 non-null    int64  
 3   Name         891 non-null    object 
 4   Sex          891 non-null    object 
 5   Age          714 non-null    float64
 6   SibSp        891 non-null    int64  
 7   Parch        891 non-null    int64  
 8   Ticket       891 non-null    object 
 9   Fare         891 non-null    float64
 10  Cabin        204 non-null    object 
 11  Embarked     889 non-null    object 
dtypes: float64(2), int64(5), object(5)
memory usage: 83.7+ KB
----------------------------------------
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 418 entries, 0 to 417
Data columns (total 11 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  418 non-null    int64  
 1   Pclass       418 non-null    int64  
 2   Name         418 non-null    object 
 3   Sex          418 non-null    object 
 4   Age          332 non-null    float64
 5   SibSp        418 non-null    int64  
 6   Parch        418 non-null    int64  
 7   Ticket       418 non-null    object 
 8   Fare         417 non-null    float64
 9   Cabin        91 non-null     object 
 10  Embarked     418 non-null    object 
dtypes: float64(2), int64(4), object(5)
memory usage: 36.0+ KB
</code></pre></div></div>

<p><strong>Observations</strong></p>

<ol>
  <li>The data contains 11 features. The details of these features are described on the <a href="https://www.kaggle.com/c/titanic/data">Kaggle data pape here</a>.
    <ul>
      <li>Categorical: Sex and Embarked,</li>
      <li>Orinial: Pclass,</li>
      <li>Numerical: Age and Fare (continous), SibSp and Parch (discret),</li>
      <li>Mixed: Cabin (alphanumeric).</li>
    </ul>
  </li>
  <li>There are missing values in Age, Cabin, Embarked and Fare.</li>
</ol>

<h3 id="primary-data-analysis-and-visualization">Primary data analysis and visualization</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Overall Surival Rate
</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">().</span><span class="n">plot</span><span class="p">.</span><span class="n">pie</span><span class="p">(</span><span class="n">autopct</span> <span class="o">=</span> <span class="s">'%1.2f%%'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_12_0.png" alt="png" /></p>

<h4 id="sex">Sex</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Sex  
</span><span class="n">train_data</span><span class="p">[[</span><span class="s">'Sex'</span><span class="p">,</span><span class="s">'Survived'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">([</span><span class="s">'Sex'</span><span class="p">]).</span><span class="n">mean</span><span class="p">().</span><span class="n">plot</span><span class="p">.</span><span class="n">bar</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_14_0.png" alt="png" /></p>

<p><strong>Observation</strong>: Female passengers had higher survival chance.</p>

<h4 id="class">Class</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Class  
</span><span class="n">train_data</span><span class="p">[[</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="s">'Survived'</span><span class="p">]].</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Pclass'</span><span class="p">).</span><span class="n">mean</span><span class="p">().</span><span class="n">plot</span><span class="p">.</span><span class="n">bar</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_17_0.png" alt="png" /></p>

<p><strong>Observation</strong>: Surival rate Class 1 &gt; Class 2 &gt; Class 3</p>

<h4 id="family-size">Family size</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Family Size 
</span><span class="n">train_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'Parch'</span><span class="p">]</span> <span class="o">+</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'SibSp'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> 
<span class="n">test_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'Parch'</span><span class="p">]</span> <span class="o">+</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'SibSp'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> 

<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'FamilySize'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_20_0.png" alt="png" /></p>

<p><strong>Observation:</strong> Passengers with small family size (2-4) were more likely to survive.</p>

<p>Therefore, the passengers are grouped into 3 groups according the size of family: singleton, SmallFamily (family size 2-4) and LargeFamily (family size larger than 4).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Feature engineering
</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Singleton'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s">'SmallFamily'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="mi">2</span><span class="o">&lt;=</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s">'LargeFamily'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span><span class="o">&gt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">test_data</span><span class="p">[</span><span class="s">'Singleton'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'SmallFamily'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="mi">2</span><span class="o">&lt;=</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'LargeFamily'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'FamilySize'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span><span class="o">&gt;=</span><span class="mi">5</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="age">Age</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Age &amp; Survival Rate 
</span><span class="n">age_data</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">notna</span><span class="p">()][[</span><span class="s">'Age'</span><span class="p">,</span> <span class="s">'Survived'</span><span class="p">]]</span>
<span class="n">sns</span><span class="p">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">age_data</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_24_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ageFacet</span><span class="o">=</span><span class="n">sns</span><span class="p">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="n">ageFacet</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">,</span><span class="s">'Age'</span><span class="p">,</span><span class="n">shade</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
<span class="n">ageFacet</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nb">max</span><span class="p">()));</span>
<span class="n">ageFacet</span><span class="p">.</span><span class="n">add_legend</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_25_0.png" alt="png" /></p>

<p><strong>Observation:</strong> Passengers aged under 10 were more likely to survive.</p>

<h4 id="fare">Fare</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fare &amp; Survival Rate
</span><span class="n">fareFacet</span><span class="o">=</span><span class="n">sns</span><span class="p">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span><span class="n">hue</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">,</span><span class="n">aspect</span><span class="o">=</span><span class="mi">3</span><span class="p">);</span>
<span class="n">fareFacet</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">sns</span><span class="p">.</span><span class="n">kdeplot</span><span class="p">,</span><span class="s">'Fare'</span><span class="p">,</span><span class="n">shade</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span>
<span class="n">fareFacet</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">));</span>
<span class="n">fareFacet</span><span class="p">.</span><span class="n">add_legend</span><span class="p">();</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_28_0.png" alt="png" /></p>

<p><strong>Observation:</strong> Low survival rate for fare &lt; 20.</p>

<h4 id="embarked-port">Embarked port</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Embarked &amp; Survival Rate
</span><span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="s">'Embarked'</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_31_0.png" alt="png" /></p>

<p><strong>Observations:</strong> Passengers embarked from port C were more likely to survive.</p>

<h4 id="name-title">Name (Title)</h4>

<p>The titles of the passengers can be extracted from their names. Passengers from different social classes may have different survival chance.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Extract titles
</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">extract</span><span class="p">(</span><span class="s">' ([A-Za-z]+)\.'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">.</span><span class="n">Name</span><span class="p">.</span><span class="nb">str</span><span class="p">.</span><span class="n">extract</span><span class="p">(</span><span class="s">' ([A-Za-z]+)\.'</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mr          517
Miss        182
Mrs         125
Master       40
Dr            7
Rev           6
Mlle          2
Major         2
Col           2
Ms            1
Don           1
Lady          1
Mme           1
Sir           1
Countess      1
Capt          1
Jonkheer      1
Name: Title, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Group the passengers into 6 groups by their titles.
</span><span class="n">Title_Dictionary</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="s">"Capt"</span><span class="p">:</span>       <span class="s">"Officer"</span><span class="p">,</span>
                        <span class="s">"Col"</span><span class="p">:</span>        <span class="s">"Officer"</span><span class="p">,</span>
                        <span class="s">"Major"</span><span class="p">:</span>      <span class="s">"Officer"</span><span class="p">,</span>
                        <span class="s">"Jonkheer"</span><span class="p">:</span>   <span class="s">"Royalty"</span><span class="p">,</span>
                        <span class="s">"Don"</span><span class="p">:</span>        <span class="s">"Royalty"</span><span class="p">,</span>
                        <span class="s">"Sir"</span> <span class="p">:</span>       <span class="s">"Royalty"</span><span class="p">,</span>
                        <span class="s">"Dr"</span><span class="p">:</span>         <span class="s">"Officer"</span><span class="p">,</span>
                        <span class="s">"Rev"</span><span class="p">:</span>        <span class="s">"Officer"</span><span class="p">,</span>
                        <span class="s">"Countess"</span><span class="p">:</span>   <span class="s">"Royalty"</span><span class="p">,</span>
                        <span class="s">"Dona"</span><span class="p">:</span>       <span class="s">"Royalty"</span><span class="p">,</span>
                        <span class="s">"Mme"</span><span class="p">:</span>        <span class="s">"Mrs"</span><span class="p">,</span>
                        <span class="s">"Mlle"</span><span class="p">:</span>       <span class="s">"Miss"</span><span class="p">,</span>
                        <span class="s">"Ms"</span><span class="p">:</span>         <span class="s">"Mrs"</span><span class="p">,</span>
                        <span class="s">"Mr"</span> <span class="p">:</span>        <span class="s">"Mr"</span><span class="p">,</span>
                        <span class="s">"Mrs"</span> <span class="p">:</span>       <span class="s">"Mrs"</span><span class="p">,</span>
                        <span class="s">"Miss"</span> <span class="p">:</span>      <span class="s">"Miss"</span><span class="p">,</span>
                        <span class="s">"Master"</span> <span class="p">:</span>    <span class="s">"Master"</span><span class="p">,</span>
                        <span class="s">"Lady"</span> <span class="p">:</span>      <span class="s">"Royalty"</span>
                        <span class="p">}</span>
<span class="n">train_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span><span class="o">=</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="n">Title_Dictionary</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">]</span><span class="o">=</span><span class="n">test_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="n">Title_Dictionary</span><span class="p">)</span>
<span class="n">train_data</span><span class="p">[</span><span class="s">'Title'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Mr         517
Miss       184
Mrs        127
Master      40
Officer     18
Royalty      5
Name: Title, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Title'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_36_0.png" alt="png" /></p>

<p><strong>Observation:</strong> Passengers with “Mr” and “Officer” titles had low survival chance.</p>

<h4 id="cabin">Cabin</h4>
<p>The Cabin information can tell which decks the passengers were resided, which may influence the survival rate. 
The Cabin variables have many missing values. THe missing values will be replaced by “Unknown”.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">]</span> <span class="o">=</span> <span class="n">train_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">'Unknown'</span><span class="p">)</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">'Unknown'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Cabin 
</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Deck'</span><span class="p">]</span><span class="o">=</span><span class="n">train_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">test_data</span><span class="p">[</span><span class="s">'Deck'</span><span class="p">]</span><span class="o">=</span><span class="n">test_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="p">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s">'Deck'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Survived'</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_40_0.png" alt="png" /></p>

<p><strong>Observation:</strong> Passengers in Deck B, D, E were more likely to survive.</p>

<h3 id="data-pre-processing">Data pre-processing</h3>

<h4 id="combine-all-data">Combine all data</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="fill-the-missing-values">Fill the missing values</h4>

<h5 id="embarked">Embarked</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Embarked
</span><span class="n">full_data</span><span class="p">[</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()]</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>FamilySize</th>
      <th>Singleton</th>
      <th>SmallFamily</th>
      <th>LargeFamily</th>
      <th>Title</th>
      <th>Deck</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>61</th>
      <td>62</td>
      <td>1.0</td>
      <td>1</td>
      <td>Icard, Miss. Amelie</td>
      <td>female</td>
      <td>38.0</td>
      <td>0</td>
      <td>0</td>
      <td>113572</td>
      <td>80.0</td>
      <td>B28</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Miss</td>
      <td>B</td>
    </tr>
    <tr>
      <th>829</th>
      <td>830</td>
      <td>1.0</td>
      <td>1</td>
      <td>Stone, Mrs. George Nelson (Martha Evelyn)</td>
      <td>female</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>113572</td>
      <td>80.0</td>
      <td>B28</td>
      <td>NaN</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Mrs</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_data</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S    914
C    270
Q    123
Name: Embarked, dtype: int64
</code></pre></div></div>

<p>Fill the missing value of the Embarked feature with the most frequent value.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_data</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_data</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="s">'S'</span><span class="p">)</span>
</code></pre></div></div>

<h5 id="fare-1">Fare</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fare 
</span><span class="n">full_data</span><span class="p">[</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()]</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>FamilySize</th>
      <th>Singleton</th>
      <th>SmallFamily</th>
      <th>LargeFamily</th>
      <th>Title</th>
      <th>Deck</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>152</th>
      <td>1044</td>
      <td>NaN</td>
      <td>3</td>
      <td>Storey, Mr. Thomas</td>
      <td>male</td>
      <td>60.5</td>
      <td>0</td>
      <td>0</td>
      <td>3701</td>
      <td>NaN</td>
      <td>Unknown</td>
      <td>S</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Mr</td>
      <td>U</td>
    </tr>
  </tbody>
</table>
</div>

<p>Fill the missing value of the Fare feature with the mean value.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_data</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">]</span><span class="o">=</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">fillna</span><span class="p">(</span><span class="n">full_data</span><span class="p">[(</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">]</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Embarked'</span><span class="p">]</span><span class="o">==</span><span class="s">'S'</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Cabin'</span><span class="p">]</span><span class="o">==</span><span class="s">'Unknown'</span><span class="p">)][</span><span class="s">'Fare'</span><span class="p">].</span><span class="n">mean</span><span class="p">())</span>
</code></pre></div></div>

<h5 id="age-1">Age</h5>
<p>The Random Forest algorithm is used to fill the missing of the Age feature.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">AgePre</span> <span class="o">=</span> <span class="n">full_data</span><span class="p">[[</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'Pclass'</span><span class="p">,</span><span class="s">'Title'</span><span class="p">,</span><span class="s">'FamilySize'</span><span class="p">,</span><span class="s">'Sex'</span><span class="p">]]</span>
<span class="n">AgePre</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">AgePre</span><span class="p">)</span>
<span class="n">AgePre</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Pclass</th>
      <th>FamilySize</th>
      <th>Title_Master</th>
      <th>Title_Miss</th>
      <th>Title_Mr</th>
      <th>Title_Mrs</th>
      <th>Title_Officer</th>
      <th>Title_Royalty</th>
      <th>Sex_female</th>
      <th>Sex_male</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.0</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35.0</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>35.0</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Split the dateset
</span><span class="n">AgeKnown</span><span class="o">=</span><span class="n">AgePre</span><span class="p">[</span><span class="n">AgePre</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">AgeUnKnown</span><span class="o">=</span><span class="n">AgePre</span><span class="p">[</span><span class="n">AgePre</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()]</span>

<span class="n">AgeKnown_X</span><span class="o">=</span><span class="n">AgeKnown</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Age'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">AgeKnown_y</span><span class="o">=</span><span class="n">AgeKnown</span><span class="p">[</span><span class="s">'Age'</span><span class="p">]</span>

<span class="n">AgeUnKnown_X</span><span class="o">=</span><span class="n">AgeUnKnown</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Age'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Setup the random forest model
</span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">rfr</span><span class="o">=</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">rfr</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">AgeKnown_X</span><span class="p">,</span><span class="n">AgeKnown_y</span><span class="p">)</span>

<span class="c1"># Model evaluation
</span><span class="n">rfr</span><span class="p">.</span><span class="n">score</span><span class="p">(</span><span class="n">AgeKnown_X</span><span class="p">,</span><span class="n">AgeKnown_y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0.4911278076281459
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Predict age
</span><span class="n">AgeUnKnown_y</span><span class="o">=</span><span class="n">rfr</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">AgeUnKnown_X</span><span class="p">)</span>
<span class="c1"># Fill the mssing value
</span><span class="n">full_data</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="n">isnull</span><span class="p">(),[</span><span class="s">'Age'</span><span class="p">]]</span><span class="o">=</span><span class="n">AgeUnKnown_y</span>
<span class="c1"># Create featuer IsChild (less than 10 years old)
</span><span class="n">full_data</span><span class="p">[</span><span class="s">'IsChild'</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_data</span><span class="p">[</span><span class="s">'Age'</span><span class="p">].</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">s</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">s</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">full_data</span><span class="p">.</span><span class="n">info</span><span class="p">()</span> <span class="c1"># no missing values now (except Survived)
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 1309 entries, 0 to 417
Data columns (total 19 columns):
 #   Column       Non-Null Count  Dtype  
---  ------       --------------  -----  
 0   PassengerId  1309 non-null   int64  
 1   Survived     891 non-null    float64
 2   Pclass       1309 non-null   int64  
 3   Name         1309 non-null   object 
 4   Sex          1309 non-null   object 
 5   Age          1309 non-null   float64
 6   SibSp        1309 non-null   int64  
 7   Parch        1309 non-null   int64  
 8   Ticket       1309 non-null   object 
 9   Fare         1309 non-null   float64
 10  Cabin        1309 non-null   object 
 11  Embarked     1309 non-null   object 
 12  FamilySize   1309 non-null   int64  
 13  Singleton    1309 non-null   int64  
 14  SmallFamily  1309 non-null   int64  
 15  LargeFamily  1309 non-null   int64  
 16  Title        1309 non-null   object 
 17  Deck         1309 non-null   object 
 18  IsChild      1309 non-null   int64  
dtypes: float64(3), int64(9), object(7)
memory usage: 204.5+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">full_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>FamilySize</th>
      <th>Singleton</th>
      <th>SmallFamily</th>
      <th>LargeFamily</th>
      <th>Title</th>
      <th>Deck</th>
      <th>IsChild</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>Unknown</td>
      <td>S</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Mr</td>
      <td>U</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.0</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Mrs</td>
      <td>C</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.0</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>Unknown</td>
      <td>S</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Miss</td>
      <td>U</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.0</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>Mrs</td>
      <td>C</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>0.0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>Unknown</td>
      <td>S</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>Mr</td>
      <td>U</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<h4 id="select-the-features">Select the features</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Remove the less revelant features
</span><span class="n">fullSel</span><span class="o">=</span><span class="n">full_data</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'Cabin'</span><span class="p">,</span><span class="s">'Name'</span><span class="p">,</span><span class="s">'Ticket'</span><span class="p">,</span><span class="s">'PassengerId'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Check the correlations of the features
</span><span class="n">corrDf</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">corrDf</span><span class="o">=</span><span class="n">fullSel</span><span class="p">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corrDf</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">].</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Pclass        -0.338481
Singleton     -0.203367
LargeFamily   -0.125147
Age           -0.065783
SibSp         -0.035322
FamilySize     0.016639
Parch          0.081629
IsChild        0.125678
Fare           0.257307
SmallFamily    0.279855
Survived       1.000000
Name: Survived, dtype: float64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Heatmap
</span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">));</span>
<span class="n">sns</span><span class="p">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">fullSel</span><span class="p">[[</span><span class="s">'Survived'</span><span class="p">,</span><span class="s">'Age'</span><span class="p">,</span><span class="s">'Embarked'</span><span class="p">,</span><span class="s">'Fare'</span><span class="p">,</span><span class="s">'Parch'</span><span class="p">,</span><span class="s">'Pclass'</span><span class="p">,</span>
                    <span class="s">'Sex'</span><span class="p">,</span><span class="s">'SibSp'</span><span class="p">,</span><span class="s">'Title'</span><span class="p">,</span><span class="s">'Singleton'</span><span class="p">,</span><span class="s">'SmallFamily'</span><span class="p">,</span><span class="s">'LargeFamily'</span><span class="p">,</span><span class="s">'FamilySize'</span><span class="p">,</span><span class="s">'IsChild'</span><span class="p">,</span><span class="s">'Deck'</span><span class="p">]].</span><span class="n">corr</span><span class="p">(),</span><span class="n">cmap</span><span class="o">=</span><span class="s">'BrBG'</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
           <span class="n">linewidths</span><span class="o">=</span><span class="p">.</span><span class="mi">5</span><span class="p">);</span>
<span class="n">plt</span><span class="p">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">);</span>
</code></pre></div></div>

<p><img src="/assets/img/posts/Titanic.markdown_files/Titanic.markdown_62_0.png" alt="png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="o">=</span><span class="n">fullSel</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'SibSp'</span><span class="p">,</span><span class="s">'Parch'</span><span class="p">,</span><span class="s">'FamilySize'</span><span class="p">,</span><span class="s">'Age'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="one-hot-encoding">One-hot encoding</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># One-hot encoding
</span><span class="n">fullSel</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">fullSel</span><span class="p">)</span>
<span class="n">PclassDf</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">full_data</span><span class="p">[</span><span class="s">'Pclass'</span><span class="p">],</span><span class="n">prefix</span><span class="o">=</span><span class="s">'Pclass'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PclassDf</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass_1</th>
      <th>Pclass_2</th>
      <th>Pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">concat</span><span class="p">([</span><span class="n">fullSel</span><span class="p">,</span> <span class="n">PclassDf</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Pclass'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Fare</th>
      <th>Singleton</th>
      <th>SmallFamily</th>
      <th>LargeFamily</th>
      <th>IsChild</th>
      <th>Sex_female</th>
      <th>Sex_male</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
      <th>...</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>Deck_E</th>
      <th>Deck_F</th>
      <th>Deck_G</th>
      <th>Deck_T</th>
      <th>Deck_U</th>
      <th>Pclass_1</th>
      <th>Pclass_2</th>
      <th>Pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>7.2500</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>71.2833</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>7.9250</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>53.1000</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>8.0500</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
  <p>5 rows × 29 columns</p>
</div>

<h4 id="normalization">Normalization</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="p">[</span><span class="n">fullSel</span><span class="p">.</span><span class="n">columns</span><span class="p">]</span> <span class="o">=</span> <span class="n">fullSel</span><span class="p">[</span><span class="n">fullSel</span><span class="p">.</span><span class="n">columns</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">.</span><span class="nb">max</span><span class="p">(),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div style="overflow-x:auto;">
  <style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

  <table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
      <th>Fare</th>
      <th>Singleton</th>
      <th>SmallFamily</th>
      <th>LargeFamily</th>
      <th>IsChild</th>
      <th>Sex_female</th>
      <th>Sex_male</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
      <th>...</th>
      <th>Deck_C</th>
      <th>Deck_D</th>
      <th>Deck_E</th>
      <th>Deck_F</th>
      <th>Deck_G</th>
      <th>Deck_T</th>
      <th>Deck_U</th>
      <th>Pclass_1</th>
      <th>Pclass_2</th>
      <th>Pclass_3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.014151</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.139136</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.0</td>
      <td>0.015469</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.0</td>
      <td>0.103644</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.015713</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
  <p>5 rows × 29 columns</p>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fullSel</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'combined_data.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="split-the-dataset">Split the dataset</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">train</span> <span class="o">=</span> <span class="n">fullSel</span><span class="p">[</span><span class="n">fullSel</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">].</span><span class="n">notnull</span><span class="p">()]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">fullSel</span><span class="p">[</span><span class="n">fullSel</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">].</span><span class="n">isnull</span><span class="p">()]</span>
<span class="n">targets</span> <span class="o">=</span> <span class="n">train</span><span class="p">[</span><span class="s">'Survived'</span><span class="p">]</span>
<span class="n">train</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Survived'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">test</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'Survived'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span><span class="n">X_val</span><span class="p">,</span><span class="n">Y_train</span><span class="p">,</span><span class="n">Y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">targets</span><span class="p">,</span><span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span><span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="define-the-model">Define the model</h2>
<p>A neural network model with 3 layers are chosen. The model is implemented using Keras.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">X_train</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Y_train</span>
<span class="n">L1</span><span class="o">=</span><span class="mi">20</span>
<span class="n">L2</span><span class="o">=</span><span class="mi">20</span>
<span class="n">L3</span><span class="o">=</span><span class="mi">5</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],),</span><span class="n">kernel_regularizer</span><span class="o">=</span><span class="s">'l2'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span><span class="n">kernel_regularizer</span><span class="o">=</span><span class="s">'l2'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">L3</span><span class="p">,</span><span class="n">kernel_regularizer</span><span class="o">=</span><span class="s">'l2'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'relu'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="p">.</span><span class="n">keras</span><span class="p">.</span><span class="n">layers</span><span class="p">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">kernel_regularizer</span><span class="o">=</span><span class="s">'l2'</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s">'sigmoid'</span><span class="p">))</span>
<span class="n">model</span><span class="p">.</span><span class="nb">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s">'adam'</span><span class="p">,</span><span class="n">loss</span><span class="o">=</span><span class="s">'binary_crossentropy'</span><span class="p">,</span><span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">])</span>
</code></pre></div></div>

<h2 id="train-and-fine-tune-model">Train and fine-tune model</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">epoch</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="n">epoch</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y_val</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Loss = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Test Accuracy = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Training Accuracy = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loss = 0.5216637253761292
Test Accuracy = 0.826815664768219
Training Accuracy = 0.8300561904907227
</code></pre></div></div>
<p><strong>Observation:</strong> Test accuracy and training accuracy are close, indicating that the model is not over-fitting.</p>

<p>Retrain the model with all training data.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span><span class="n">targets</span><span class="p">,</span><span class="n">epochs</span><span class="o">=</span><span class="n">epoch</span><span class="p">,</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y_val</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Loss = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">preds</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="k">print</span> <span class="p">(</span><span class="s">"Accuracy = "</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">history</span><span class="p">.</span><span class="n">history</span><span class="p">[</span><span class="s">'accuracy'</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Loss = 0.49221670627593994
Accuracy = 0.8316498398780823
</code></pre></div></div>

<h2 id="test-and-deploy-model">Test and deploy model</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">l</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">survived</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">l</span><span class="p">]</span>
<span class="c1">#original_test_data = pd.read_csv('/kaggle/input/titanic/test.csv')
</span><span class="n">original_test_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'./Dataset/test.csv'</span><span class="p">)</span>
<span class="n">submission</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s">'PassengerId'</span><span class="p">:</span> <span class="n">original_test_data</span><span class="p">[</span><span class="s">'PassengerId'</span><span class="p">],</span>
    <span class="s">'Survived'</span><span class="p">:</span>  <span class="n">survived</span>
<span class="p">})</span>

<span class="n">submission</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'titanic-nn.csv'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>Submission of this result on Kaggle results in a public score of 0.77751,  ranking 4428th out of 16823 at the time of writing.</p>

<h2 id="references">References</h2>
<p>This tutorial has been created based on great work done solving the Titanic competition and machine learning.</p>
<ol>
  <li><a href="https://zhuanlan.zhihu.com/p/50194676">https://zhuanlan.zhihu.com/p/50194676</a></li>
  <li><a href="https://www.kaggle.com/startupsci/titanic-data-science-solutions">https://www.kaggle.com/startupsci/titanic-data-science-solutions</a></li>
  <li><a href="https://www.kdnuggets.com/2020/09/mathworks-deep-learning-workflow.html">https://www.kdnuggets.com/2020/09/mathworks-deep-learning-workflow.html</a> <a name="ref3"></a></li>
</ol>

  </article>
</div>

<div class="share-buttons">
  <h6>Share on: </h6>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras" class="twitter btn" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras" class="facebook btn" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
<!-- remove Goolge Plus and Hacker-new share buttons
    <li>
      <a href="https://plus.google.com/share?url=https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras" class="google-plus btn" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
    <li>
      <a href="https://news.ycombinator.com/submitlink?u=https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras" class="hacker-news btn" title="Share on Hacker News"><i class="fa fa-hacker-news"></i><span> Hacker News</span></a>
    </li>
-->
    <li>
      <a href="https://www.reddit.com/submit?url=https://sulibo.github.io/articles/2020-11/kaggle-titanic-competition-with-deep-neural-network-using-keras" class="reddit btn" title="Share on Reddit"><i class="fa fa-reddit"></i><span> Reddit</span></a>
    </li>
  </ul>
</div><!-- end share-buttons -->


<div>
  
    <a style="float: left; font-weight: bold; " href="/articles/2020-07/kalman_filter">&laquo; Kalman filter</a>
  
  
    <a style="float: right; font-weight: bold; " href="/articles/2020-11/digit-recognizer-cnn">A Short Tutorial on Building a Digit Recognizer Using CNN &raquo;</a>
  
  <br><br>
</div>


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'libosu';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


  

        <footer>
  &copy; 2020 Libo Su. Powered by <a href="http://octopress.org/">Octopress 3.0</a> and <a href="http://github.com/renyuanz/leonids/">Leonids theme</a>.
</footer>

      </div>
    </div>
    <div class="col s12 m3">
      <div class="table under-cover">
        
<div class="table-cell table-middle">
  
     
      

      
        <div class="toc">
        <h4>Table of Contents</h4>
        
        <ol id="post-toc">
  <li><a href="#define-the-problem">Define the problem</a></li>
  <li><a href="#acquire-the-data">Acquire the data</a></li>
  <li><a href="#prepare-the-data">Prepare the data</a>
    <ol>
      <li><a href="#data-overview">Data Overview</a></li>
      <li><a href="#primary-data-analysis-and-visualization">Primary data analysis and visualization</a>
        <ol>
          <li><a href="#sex">Sex</a></li>
          <li><a href="#class">Class</a></li>
          <li><a href="#family-size">Family size</a></li>
          <li><a href="#age">Age</a></li>
          <li><a href="#fare">Fare</a></li>
          <li><a href="#embarked-port">Embarked port</a></li>
          <li><a href="#name-title">Name (Title)</a></li>
          <li><a href="#cabin">Cabin</a></li>
        </ol>
      </li>
      <li><a href="#data-pre-processing">Data pre-processing</a>
        <ol>
          <li><a href="#combine-all-data">Combine all data</a></li>
          <li><a href="#fill-the-missing-values">Fill the missing values</a>
            <ol>
              <li><a href="#embarked">Embarked</a></li>
              <li><a href="#fare-1">Fare</a></li>
              <li><a href="#age-1">Age</a></li>
            </ol>
          </li>
          <li><a href="#select-the-features">Select the features</a></li>
          <li><a href="#one-hot-encoding">One-hot encoding</a></li>
          <li><a href="#normalization">Normalization</a></li>
        </ol>
      </li>
      <li><a href="#split-the-dataset">Split the dataset</a></li>
    </ol>
  </li>
  <li><a href="#define-the-model">Define the model</a></li>
  <li><a href="#train-and-fine-tune-model">Train and fine-tune model</a></li>
  <li><a href="#test-and-deploy-model">Test and deploy model</a></li>
  <li><a href="#references">References</a></li>
</ol>

      
        </div>
      
    
  
</div>


      </div>
    </div>
  </div>
  <script type="text/javascript" src="https://sulibo.github.io//assets/js/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="https://sulibo.github.io//assets/js/main.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-42887873-1', 'auto');
  ga('send', 'pageview');
</script>




<!--back-to-top-button-->    
  <script src="https://sulibo.github.io//assets/js/back-to-top.js"></script>

<!--toc-highlight-->    
  <script src="https://sulibo.github.io//assets/js/locate-toc-list.js"></script>

<!--LaTeX support-->
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']], // $...$ as math delimiters
    processEscapes: true,      // use \\$ to produce a literal dollar sign
    tags: 'ams',               // automatic numbering 
    useLabelIds: true,         // using label not tag for cross reference  
    processEnvironments: true, // process \begin{xxx}...\end{xxx} outside math mode
    processRefs: true          // process \ref{...} outside of math mode
  },
  svg: {
    fontCache: 'global'
  },
  options: {
    renderActions: {
      findScript: [10, function (doc) {
        for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
          const display = !!node.type.match(/; *mode=display/);
          const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
          const text = document.createTextNode('');
          node.parentNode.replaceChild(text, node);
          math.start = {node: text, delim: '', n: 0};
          math.end = {node: text, delim: '', n: 0};
          doc.math.push(math);
        }
      }, '']
    }
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>


  <button id="btn-top" class="btn-top" title= "Go to top">&#9650</button>
</body>
</html>
